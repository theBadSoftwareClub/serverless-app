version: '3.3'

services:
  development:
    build: ./Client
    expose:
      - 3000
    environment:
      CHOKIDAR_USEPOLLING: 'true'
      REACT_APP_APP_URL: 'https://exampleapp.domainname.net'
      REACT_APP_API_URL: 'https://exampleapi.domainname.net'
      REACT_APP_AUTH_DOMAIN: 'exampleauth.domainname.net'
      REACT_APP_AWS_REGION: 'us-east-1'
      REACT_APP_AWS_USERPOOLID: ''
      REACT_APP_AWS_USERPOOLCLIENTID: '

    ports:
      - 80:3000
    volumes:
      - ./Client/src:/usr/src/app/src
      - ./Client/public:/usr/src/app/public
    command: npm run start
    stdin_open: true
    tty: true
  production:
    build: ./Client
    depends_on:
      - development
    environment:
      REACT_APP_APP_URL: 'https://exampleapp.domainname.net'
      REACT_APP_API_URL: 'https://exampleapi.domainname.net'
      REACT_APP_AUTH_DOMAIN: 'exampleauth.domainname.net'
      REACT_APP_AWS_REGION: 'us-east-1'
      REACT_APP_AWS_USERPOOLID: ''
      REACT_APP_AWS_USERPOOLCLIENTID: '

    volumes:
      - ./Client/src:/usr/src/app/src
      - ./Client/public:/usr/src/app/public
      - ./Client/build:/usr/src/app/build
    command: npm run build
